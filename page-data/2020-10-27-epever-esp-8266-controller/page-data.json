{"componentChunkName":"component---src-templates-post-js","path":"/2020-10-27-epever-esp-8266-controller","result":{"data":{"markdownRemark":{"html":"<p>Cheaper MPPT solar charge controllers have become ubiquitous. Many of these sport <a href=\"https://en.wikipedia.org/wiki/RS-232\">RS232</a> or <a href=\"https://en.wikipedia.org/wiki/RS-485\">RS485</a>/<a href=\"https://en.wikipedia.org/wiki/Modbus\">Modbus</a> ports\nallowing the controllers to be extended via proprietary hardware/software for advanced monitoring and control use-cases.</p>\n<p>Since this Spring I have been experimenting with the EPever (EPSolar) line of MPPT solar charge controllers which have RS485 interfaces and thought it would be worthwhile to share my\nlearnings in the hope they will be useful to others.</p>\n<p>This post will focus on the specific hardware I worked with, however the techniques are applicable to similar hardware.</p>\n<p>At the bottom of this post I have linked to similar projects and build logs - while there are many, I believe the content here adds materially in terms of discussing the downsides of using the Raspberry Pi for this application\nand, for the esp8266 part of the build, showing the simpler wiring which results from choosing an RS485 adapter which does automatic flow control.</p>\n<h2 id=\"the-first-pi\" style=\"position:relative;\"><a href=\"#the-first-pi\" aria-label=\"the first pi permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The First Pi</h2>\n<p>Early in the Spring I was configuring a couple tiny independent solar systems - one to power networking hardware to get internet on an off-grid property from a local <a href=\"https://en.wikipedia.org/wiki/Wireless_Internet_service_provider\">WISP</a>\nand another to provide incidental power for the construction phase of my skoolie conversion.</p>\n<p>Naturally, I wanted to capture data on the performance of these systems over time to help gain a more intuitive hands-on understanding of the power small \"renewable\" energy systems can provide. Also\nI anticipate the data will be helpful in understanding the aging of the systems' batteries - and possibly panels.</p>\n<p>My initial attempts involved a Raspberry Pi 3B and a RS485-to-RS232 adapter. I used a bit of python code and the excellent <a href=\"https://github.com/Salamek/epsolar-tracer\">epsolar-tracer</a> library to poll the\nTracer 3210AN and publishing metrics to <a href=\"https://graphiteapp.org/\">Carbon/Graphite</a>.</p>\n<p>After a fairly steep learning curve with half-duplex RS485 adapters, I got that working and was pleased to have some day-over-day performance data.</p>\n<p>At this point my main complaint was that since only one device can connect to the RS485 port at a time, I couldn't have both remote monitoring and the handy <a href=\"https://www.epsolarpv.com/product/55.html\">MT-50</a> connected simultaneously.</p>\n<h2 id=\"the-second-pi\" style=\"position:relative;\"><a href=\"#the-second-pi\" aria-label=\"the second pi permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The Second Pi</h2>\n<p>I set out to figure out how to get both the local display and remote monitoring working at the same time.</p>\n<p>Since the Raspberry Pi only has 1 hardware serial port, I got some <a href=\"https://www.amazon.com/dp/B00LZV1G6K/\">USB serial adapters</a> and decided to proxy requests from the MT-50 while still polling for data to publish to Carbon.</p>\n<p>Proxying the requests was unexpectedly complicated because I discovered that the MT-50 doesn't read data via the <a href=\"http://www.solar-elektro.cz/data/dokumenty/1733_modbus_protocol.pdf\">documented modbus commands</a>.\nMost important of the undocumented commands the MT-50 uses is one for reading sparse/discontiguous registers which I have documented in <a href=\"https://gist.github.com/symbioquine/95ba2abaf046c8e034b41e4cf3c334a9\">this gist</a>.</p>\n<p>With the protocol bits figured out and a nice watertight box, I had a passable system component which publishes metrics and still allows the local display to work.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 690px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7e28122fe2d5b6daba704bcdedc5a5d6/72e01/second_pi.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.14450867052024%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABAAC/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAXCYCH2av//EABoQAAIDAQEAAAAAAAAAAAAAAAECABESIQT/2gAIAQEAAQUCE1Xo4Z0B8WjWv//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EAB0QAAEDBQEAAAAAAAAAAAAAAAABITEQERIiMqH/2gAIAQEABj8Cgy2t5Tk6dFGg/8QAHBAAAwACAwEAAAAAAAAAAAAAAAERMUFRYZHB/9oACAEBAAE/IZX3R17TUG1FYdNdMfJkY0/CQ54H/9oADAMBAAIAAwAAABCPD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQWFxwdH/2gAIAQEAAT8QzASG0AlxDYGBoFjfVwBxoxbkxyfuokhjrFR4StC1byGPs//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"A Raspberry Pi in a watertight box with dual usb-serial and RS232-to-RS485 adapters\"\n        title=\"A Raspberry Pi in a watertight box with dual usb-serial and RS232-to-RS485 adapters\"\n        src=\"/static/7e28122fe2d5b6daba704bcdedc5a5d6/15ec7/second_pi.jpg\"\n        srcset=\"/static/7e28122fe2d5b6daba704bcdedc5a5d6/9ac50/second_pi.jpg 173w,\n/static/7e28122fe2d5b6daba704bcdedc5a5d6/8d48c/second_pi.jpg 345w,\n/static/7e28122fe2d5b6daba704bcdedc5a5d6/15ec7/second_pi.jpg 690w,\n/static/7e28122fe2d5b6daba704bcdedc5a5d6/72e01/second_pi.jpg 1024w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Unfortunately, there were still several issues with this strategy;</p>\n<ul>\n<li>Raspberry Pi fail due to how quickly SD cards wear out and result in filesystem corruption - this is supposedly surmountable by limiting or completely disabling writes, but I haven't figured out how to do this while still\nkeep the ability to remotely push control-program/OS updates</li>\n<li>Raspberry Pi use quite a bit of energy - over 1 watt <a href=\"http://www.pidramble.com/wiki/benchmarks/power-consumption\">even idle</a></li>\n<li>The easiest way I found to securely publish to Carbon was via an SSH tunnel which adds unnecessary complexity and failure-points</li>\n<li>The Raspberry Pi is powered from the 'load' output of the charge controller - meaning the Pi can't be used for toggling power to the load without also turning itself off</li>\n</ul>\n<h2 id=\"and-now-for-something-a-little-different\" style=\"position:relative;\"><a href=\"#and-now-for-something-a-little-different\" aria-label=\"and now for something a little different permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>And Now for Something A Little Different</h2>\n<p>I decided to drop the Raspberry Pi and MT-50 in favor of a much simpler component built around the esp8266. This has a number of advantages;</p>\n<ul>\n<li>Low power - I haven't spent much effort optimizing here, but it seems to be on the order of half a watt under load</li>\n<li>Reliability - there are many fewer points of failure without the complexities of a full OS/filesystem/etc while still supporting remote updates</li>\n<li>1 plug - since the esp8266 uses so little power, it can powered directly via the charge controller's RS485 port allowing for the unit to remain powered even when the charge controller load output is off</li>\n</ul>\n<p>Maintaining the ssh tunnel from the esp8266 didn't seem practical so I switched to publishing the metrics to an authenticated InfluxDB endpoint over HTTPS.</p>\n<h3 id=\"materials\" style=\"position:relative;\"><a href=\"#materials\" aria-label=\"materials permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Materials</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 690px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2b0d73af4c758816812455437f86e967/2b013/materials.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.95953757225434%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQBAgP/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABc0leGyhX/8QAHBAAAgAHAAAAAAAAAAAAAAAAAQIAAxAREjEz/9oACAEBAAEFAsSYM0Kwe9H7Lr//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAbEAACAgMBAAAAAAAAAAAAAAABEQAQITFxgf/aAAgBAQAGPwJMj2LLM1Q4a//EABsQAQADAQADAAAAAAAAAAAAAAEAESExEJHw/9oACAEBAAE/ISwh302ypbAvcyObT7labBr9Z4f/2gAMAwEAAgADAAAAEOvP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8QR//EAB4QAAICAgIDAAAAAAAAAAAAAAERACExQVFhgbHw/9oACAEBAAE/EHQW1xbfQ1EMDBsAQeG4lwfnELFYI63B57Hti4UMz//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Consumable materials used in this build\"\n        title=\"Consumable materials used in this build\"\n        src=\"/static/2b0d73af4c758816812455437f86e967/15ec7/materials.jpg\"\n        srcset=\"/static/2b0d73af4c758816812455437f86e967/9ac50/materials.jpg 173w,\n/static/2b0d73af4c758816812455437f86e967/8d48c/materials.jpg 345w,\n/static/2b0d73af4c758816812455437f86e967/15ec7/materials.jpg 690w,\n/static/2b0d73af4c758816812455437f86e967/af659/materials.jpg 1035w,\n/static/2b0d73af4c758816812455437f86e967/89b2d/materials.jpg 1380w,\n/static/2b0d73af4c758816812455437f86e967/2b013/materials.jpg 1700w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li><a href=\"https://www.amazon.com/dp/B081CSJV2V/\">ESP8266</a></li>\n<li><a href=\"https://www.amazon.com/dp/B082Y19KV9/\">Automatic Flow Control UART to RS485 Converter</a></li>\n<li><a href=\"https://www.amazon.com/dp/B07K7445H5/\">RJ45 Waterproof Coupler</a> - There are probably more cost effective options and the threads are a little fragile on these</li>\n<li><a href=\"https://www.thermofisher.com/order/catalog/product/2118-0008\">Nalgene 2118-0008</a> - Any convenient container should also work</li>\n<li>5 Female jumper wires</li>\n<li>~4 inches of ethernet cable with one end installed</li>\n<li>Ethernet cable to connect assembled device to the charge controller</li>\n<li>Solder</li>\n<li>Tools</li>\n</ul>\n<h3 id=\"the-build\" style=\"position:relative;\"><a href=\"#the-build\" aria-label=\"the build permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The Build</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 690px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/590d0a621de6429fd181959e68927812/a878e/diagram_wiring.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.86705202312138%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAuBAAALgQETQ8PIAAAB2klEQVQoz52SW2sTQRiG8z+0eEhpMRhiL7TWEwiKN1KQUhSpt16IECSaGxWNYk2LFQX9D2JzpaKFaG2iUSgqosRsswrxYmF7MNmkuptsdudxNmsMRkH0hXcO3zDPN9/MBIQQtO1JNBqgLyJqNdxKRdr40fumWkMYFYQ3Nk0aS8vYKytgGDJuEKBbTUGzvIwjLDlxvRS/LjdWf44fP0lz8/o4yWSCl9ksWBYB13FR1QIflDcsqO+oGTqmVkQt5Llx+xZXxhNMTk2QnLzKxNQ1PiqvMWufWf1SYuzIMH29PQSDa7l4JibzuwTq9TozDx/w6P495mTGUrGIJqF30mmG9u9j++5t7Ny7i/5wiNBAhGcvZihpeQqfioyODhOJhBjcGub82Xjr1AFXUlVlgcLb96j5Ao5ptxYWy0uk5zJknmeZfzXPbDZD+uks1arhl+7YjB0doT/Yw2AkyIVzp32g11h1C1P6q/lN3pq8MyH4m5q2zYnjxzi0ZwtDmzcSjZ70gaJ7s8fDf3XHcX6zV5En225weOQgB3aEGdi0jnj8VAfY7Rb3D/GO/dyxWJRQ33p6N6zh0uVEp+R/kQdsn1JRFFKpaVLTd8nlcv8PbFdhyX+n6zqaplEul1ux7/rnvar/3rA8AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Wiring diagram showing RS485 connection through adapter to ESP8266\"\n        title=\"Wiring diagram showing RS485 connection through adapter to ESP8266\"\n        src=\"/static/590d0a621de6429fd181959e68927812/1e043/diagram_wiring.png\"\n        srcset=\"/static/590d0a621de6429fd181959e68927812/991de/diagram_wiring.png 173w,\n/static/590d0a621de6429fd181959e68927812/e4d6b/diagram_wiring.png 345w,\n/static/590d0a621de6429fd181959e68927812/1e043/diagram_wiring.png 690w,\n/static/590d0a621de6429fd181959e68927812/e3189/diagram_wiring.png 1035w,\n/static/590d0a621de6429fd181959e68927812/b1001/diagram_wiring.png 1380w,\n/static/590d0a621de6429fd181959e68927812/a878e/diagram_wiring.png 2048w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Start by stripping about 2\" of the outer ethernet cable housing and removing the striped wires. The ground and +5v - brown and orange respectively - are left long while the RS485 A/B wires are trimmed short.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 690px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6ec658c181f0a0e20235545aed2fbe53/40317/inner_cable_prep.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.61849710982659%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdGYWg//xAAYEAEAAwEAAAAAAAAAAAAAAAABABARE//aAAgBAQABBQLkkNK//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGhAAAQUBAAAAAAAAAAAAAAAAAQACEDIzgf/aAAgBAQAGPwLVyuTyP//EABkQAQADAQEAAAAAAAAAAAAAAAEAESFxgf/aAAgBAQABPyEUoN8ganwIGa3P/9oADAMBAAIAAwAAABCL/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAgIDAAAAAAAAAAAAAAABABEhMVFxkf/aAAgBAQABPxAqQlqkF9jEDnWqvI5kLlxP/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Detail image showing preparation of the cable for connection to the RS485 adapter\"\n        title=\"Detail image showing preparation of the cable for connection to the RS485 adapter\"\n        src=\"/static/6ec658c181f0a0e20235545aed2fbe53/15ec7/inner_cable_prep.jpg\"\n        srcset=\"/static/6ec658c181f0a0e20235545aed2fbe53/9ac50/inner_cable_prep.jpg 173w,\n/static/6ec658c181f0a0e20235545aed2fbe53/8d48c/inner_cable_prep.jpg 345w,\n/static/6ec658c181f0a0e20235545aed2fbe53/15ec7/inner_cable_prep.jpg 690w,\n/static/6ec658c181f0a0e20235545aed2fbe53/af659/inner_cable_prep.jpg 1035w,\n/static/6ec658c181f0a0e20235545aed2fbe53/89b2d/inner_cable_prep.jpg 1380w,\n/static/6ec658c181f0a0e20235545aed2fbe53/40317/inner_cable_prep.jpg 2795w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Next the RS485 adapter is grounded.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 690px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bbb861be4270e4bc10bd42e87f44cc35/1cd85/wiring_rs485_adapter.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.52023121387285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAQFAgP/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAByxW5E4aI/8QAGhAAAwADAQAAAAAAAAAAAAAAAAEDAhARE//aAAgBAQABBQK2VXXzoxT4ND1//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAHRAAAQIHAAAAAAAAAAAAAAAAEQABAhIgMkFRgf/aAAgBAQAGPwKRjCx0rh1Zo//EABsQAQACAgMAAAAAAAAAAAAAAAEAESGBEDGR/9oACAEBAAE/Ia94KztuUMr2YIpVvgETM//aAAwDAQACAAMAAAAQh/8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHRABAAICAgMAAAAAAAAAAAAAAQARIUExYXGRsf/aAAgBAQABPxBZhtcvfyjiarfxAHtl2LzaoFhozDIUf//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Detail image showing one approach for grounding the RS485 adapter\"\n        title=\"Detail image showing one approach for grounding the RS485 adapter\"\n        src=\"/static/bbb861be4270e4bc10bd42e87f44cc35/15ec7/wiring_rs485_adapter.jpg\"\n        srcset=\"/static/bbb861be4270e4bc10bd42e87f44cc35/9ac50/wiring_rs485_adapter.jpg 173w,\n/static/bbb861be4270e4bc10bd42e87f44cc35/8d48c/wiring_rs485_adapter.jpg 345w,\n/static/bbb861be4270e4bc10bd42e87f44cc35/15ec7/wiring_rs485_adapter.jpg 690w,\n/static/bbb861be4270e4bc10bd42e87f44cc35/af659/wiring_rs485_adapter.jpg 1035w,\n/static/bbb861be4270e4bc10bd42e87f44cc35/89b2d/wiring_rs485_adapter.jpg 1380w,\n/static/bbb861be4270e4bc10bd42e87f44cc35/1cd85/wiring_rs485_adapter.jpg 2058w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Then jumper wires are added to the adapter and the whole thing is assembled into the case.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 690px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1f51e020e1b0fc4e5d5838b537f4bd2a/23d91/fully_assembled_cable_and_lid.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.28901734104046%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBP/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAa7qOQHD/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAECEQMQEv/aAAgBAQABBQLnK5VOxaZ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGhAAAgIDAAAAAAAAAAAAAAAAATEAAhEgQf/aAAgBAQAGPwI3NUhmci0//8QAGhAAAgMBAQAAAAAAAAAAAAAAAAERITEQcf/aAAgBAQABPyFLemMdWJUse6XxeGj/2gAMAwEAAgADAAAAEIgv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAMBAQEAAAAAAAAAAAAAAQARMSGxgf/aAAgBAQABPxBiBRUldK/OxIq5BS+AirvsJkm81n//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Image showing the assembled case lid, cable, adapter, and jumper wires\"\n        title=\"Image showing the assembled case lid, cable, adapter, and jumper wires\"\n        src=\"/static/1f51e020e1b0fc4e5d5838b537f4bd2a/15ec7/fully_assembled_cable_and_lid.jpg\"\n        srcset=\"/static/1f51e020e1b0fc4e5d5838b537f4bd2a/9ac50/fully_assembled_cable_and_lid.jpg 173w,\n/static/1f51e020e1b0fc4e5d5838b537f4bd2a/8d48c/fully_assembled_cable_and_lid.jpg 345w,\n/static/1f51e020e1b0fc4e5d5838b537f4bd2a/15ec7/fully_assembled_cable_and_lid.jpg 690w,\n/static/1f51e020e1b0fc4e5d5838b537f4bd2a/af659/fully_assembled_cable_and_lid.jpg 1035w,\n/static/1f51e020e1b0fc4e5d5838b537f4bd2a/89b2d/fully_assembled_cable_and_lid.jpg 1380w,\n/static/1f51e020e1b0fc4e5d5838b537f4bd2a/23d91/fully_assembled_cable_and_lid.jpg 3556w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Here is the fully assembled unit connected and powered up.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 690px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/84aa1f68cb564bcf56af21a1dcf9bc1e/c293a/final_all_connected.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 97.68786127167631%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBAEF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAGduO7N8xIaag4E/8QAGxABAQACAwEAAAAAAAAAAAAAAQIAAxESEyL/2gAIAQEAAQUCQMug13RdW7Lzj62T1q7R9qx2Ln//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAdEAACAQQDAAAAAAAAAAAAAAAAAREQISJBEzFx/9oACAEBAAY/ArrEbjomII4y6xovDRo//8QAHBABAAICAwEAAAAAAAAAAAAAAQARIUExUZGB/9oACAEBAAE/IeNUPeYGByKJcD+pnVK31FWBsZmADCXH3De0u14i9p4n/9oADAMBAAIAAwAAABDzL4P/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPxAYz//EABYRAAMAAAAAAAAAAAAAAAAAABEgIf/aAAgBAgEBPxAVP//EAB0QAQEAAgIDAQAAAAAAAAAAAAERACExYUFRwbH/2gAIAQEAAT8Q0OiVdF/c2ImgbV+4wYQE2veKFySHhee8VZopdXw+sfSwA9XCPSiVLDeOkudp+5cOyY//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Image showing the fully assembled unit connected and powered up\"\n        title=\"Image showing the fully assembled unit connected and powered up\"\n        src=\"/static/84aa1f68cb564bcf56af21a1dcf9bc1e/15ec7/final_all_connected.jpg\"\n        srcset=\"/static/84aa1f68cb564bcf56af21a1dcf9bc1e/9ac50/final_all_connected.jpg 173w,\n/static/84aa1f68cb564bcf56af21a1dcf9bc1e/8d48c/final_all_connected.jpg 345w,\n/static/84aa1f68cb564bcf56af21a1dcf9bc1e/15ec7/final_all_connected.jpg 690w,\n/static/84aa1f68cb564bcf56af21a1dcf9bc1e/af659/final_all_connected.jpg 1035w,\n/static/84aa1f68cb564bcf56af21a1dcf9bc1e/c293a/final_all_connected.jpg 1232w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><em>Note: for initial programming via USB it is necessary to disconnect the green (RX) wire from the esp8266. After initial programming, OTA updates can be used to avoid that step.</em></p>\n<p>In a future post I will share some sample code and provide power usage benchmarks.</p>\n<h2 id=\"related-work-of-others\" style=\"position:relative;\"><a href=\"#related-work-of-others\" aria-label=\"related work of others permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Related Work of Others</h2>\n<h3 id=\"raspberry-pi\" style=\"position:relative;\"><a href=\"#raspberry-pi\" aria-label=\"raspberry pi permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Raspberry Pi</h3>\n<ul>\n<li><a href=\"https://www.rototron.info/raspberry-pi-solar-serial-rest-api-tutorial/\">https://www.rototron.info/raspberry-pi-solar-serial-rest-api-tutorial/</a></li>\n<li><a href=\"https://stackoverflow.com/a/57351990\">https://stackoverflow.com/a/57351990</a></li>\n<li><a href=\"https://www.navitron.org.uk/forum/index.php?topic=26987.0\">https://www.navitron.org.uk/forum/index.php?topic=26987.0</a></li>\n<li><a href=\"https://diysolarforum.com/threads/off-grid-solar-battery-monitoring-and-control-freeware.6662/\">https://diysolarforum.com/threads/off-grid-solar-battery-monitoring-and-control-freeware.6662/</a></li>\n</ul>\n<h3 id=\"esp8266\" style=\"position:relative;\"><a href=\"#esp8266\" aria-label=\"esp8266 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ESP8266</h3>\n<ul>\n<li><a href=\"https://www.eevblog.com/forum/projects/nodemcu-esp8266-rs485-epever-solar-monitor-diy/\">https://www.eevblog.com/forum/projects/nodemcu-esp8266-rs485-epever-solar-monitor-diy/</a></li>\n<li><a href=\"https://www.hackster.io/tekk/cheap-mppt-controller-live-stats-on-mobile-3db5be\">https://www.hackster.io/tekk/cheap-mppt-controller-live-stats-on-mobile-3db5be</a></li>\n<li><a href=\"https://www.instructables.com/Wireless-Solar-Charge-Controller-Monitor-RS485-to-/\">https://www.instructables.com/Wireless-Solar-Charge-Controller-Monitor-RS485-to-/</a></li>\n</ul>","timeToRead":6,"excerpt":"Cheaper MPPT solar charge controllers have become ubiquitous. Many of these sport RS232 or RS485/Modbus ports\nallowing the controllers to be…","frontmatter":{"title":"EPever MPPT Solar Charge Controller Monitoring Hardware","cover":{"childImageSharp":{"fluid":{"tracedSVG":"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='236'%20viewBox='0%200%20400%20236'%20preserveAspectRatio='none'%3e%3cpath%20d='M49%2015l-8%201-8%203c-3%201-5%202-10%201-8%200-11%201-8%203%202%201%203%202%205%201h4l-5%203-9%208-5%205%202%202c3%202%203%203%201%204s-4%207-2%209c1%201%205%200%209-4h2l1-2c2-2%202-2%200%208-2%205-2%2010-2%2017%200%2017%203%2024%2011%2032%205%205%205%205%204%209v6c3%202%206%201%2017-6l14-9c12-7%2018-13%2024-22%209-16%2012-28%209-38l-2-7-1-3-5-5c-9-11-26-19-38-16m75%202l-16%201-1%206c-2%2011-1%2028%201%2030v2l1%201h46c2-1%203-2%204-5l3-6%201-7c0-5-1-5-3-5-1%200-2%200-2-4-1-4%200-4%202-4%203%200%203%200%203-3%200-2%200-3-2-3l-2-1%202-1%201-1h-38m96%208l-2%203-1-1c0-2-4-2-6-1h-1l-3-1c-2%200-2%200%200%201%201%201%201%201-1%201s-3%200-2-1l-5-1-5%201h-2c-3-2-4%201-4%2012v6l23-1c27%200%2024%200%2025-2s0-4-2-3l-2-1%203-1%201-1-3-1h-2l3-1%202-1-2-1h-2l2-1%202-1-2-1c-1%201-2%200-2-1-1-1%200-1%202-1l2-1h-16M51%2031c-10%201-15%205-21%2013-10%2016-11%2039-1%2051%203%204%203%204%205%202l1-2v-1h3l7-4c6-3%206-4%200-4l-5-2c0-1%206-2%2011-1%204%201%206%201%2010-1l6-2c6%202%2021-16%2020-23-1-2-5-2-8%201l-1%202v-2l3-7c2-6%201-7-3-4l-4%203c-1%200%200-2%202-3l4-4-2-2c-6-8-16-11-27-10m258%2045c-15%201-20%202-19%203h15l1%209%201%2010c1%203%201%203%203%202%202-2%203-2%2011-1l10-1%203-3c2-1%202-1%202%201%200%204%202%204%203%200l3-4%202-2%202-3c1-1%201-1-1-3-1-1-2-1%204-2l14-2a195%20195%200%200028-2c11-2-61-4-82-2m-201%207c0%206-1%208-2%208-2%200-2%200-1%201s-3%2014-11%2036c-6%2017-6%2031-1%2047l3%2014c0%204%201%208%204%2013l1%209c0%207%201%2010%204%206l1-13c0-12%201-25%202-23l4%2017c0%204%205%2017%207%2018%203%201%200-14-4-19-3-4-5-18-5-35s0-18%203-29c7-23%209-32%207-41l-1-4%203%201%206%201c4%202%204-1-1-2-5-3-11-2-15%201-3%202-3%203-3%200%202-4%202-11%201-11l-2%205m82-3c-1%202%201%2014%203%2031%206%2033%206%2057%202%2094l-1%2022%201%205%201-3c3-7%203-8%204-15a332%20332%200%2000-7-136l-3%202m102%2014l-1%2010c0%204%200%204-1%202l-1%209%201%209c1-2%201-2%201%202l2%205a289%20289%200%2000-1-37m-180-2c-3%204-4%207-3%2035v15l5-15c4-16%206-26%204-34-1-5-2-5-6-1m130%202c-5%201-8%207-8%2017l-1%208-2%2017a970%20970%200%20003%2098c1%202%202%202%2013%202h12v-4l3-4%203-4%202-4c1-2%202-15%201-17v-14l-1-30a162%20162%200%20011-33l-1-1c1-4%200-7-1-7-3%200-2-2%200-2%202-1%202-10%200-17-2-5-13-8-24-5m-99%202c-8%204-13%2014-15%2030-4%2024-3%2057%200%2085l2%209%201-4a345%20345%200%2001-2-92c3-17%209-26%2018-25%204%201%205%200%201-1h3c4%200%204%200%203-2h-11m-37%204l-3%208-6%2018c-5%2013-6%2023-6%2032a92%2092%200%200011%2030c2%203%202%203%203-7%202-11%203-84%201-81'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e","aspectRatio":1.7045454545454546,"src":"/static/2b0d73af4c758816812455437f86e967/4fe8c/materials.jpg","srcSet":"/static/2b0d73af4c758816812455437f86e967/aabdf/materials.jpg 150w,\n/static/2b0d73af4c758816812455437f86e967/9dc27/materials.jpg 300w,\n/static/2b0d73af4c758816812455437f86e967/4fe8c/materials.jpg 600w,\n/static/2b0d73af4c758816812455437f86e967/9842e/materials.jpg 900w,\n/static/2b0d73af4c758816812455437f86e967/47498/materials.jpg 1200w,\n/static/2b0d73af4c758816812455437f86e967/4f4f6/materials.jpg 1700w","sizes":"(max-width: 600px) 100vw, 600px"}}},"date":"2020-10-27T00:00:00.000Z","categories":["Build Logs"],"tags":["Solar","Microcontrollers","Off-grid"]},"fields":{"slug":"/2020-10-27-epever-esp-8266-controller","date":"October 27, 2020"}}},"pageContext":{"slug":"/2020-10-27-epever-esp-8266-controller","nexttitle":"Minimal git-based docker-compose deployments","nextslug":"/2021-11-30-minimal-git-based-docker-compose-deployments","prevtitle":"Pragmatic Minimal Infrastructure","prevslug":"/2020-03-14-pragmatic-minimal-infrastructure"}},"staticQueryHashes":["3969716136"]}